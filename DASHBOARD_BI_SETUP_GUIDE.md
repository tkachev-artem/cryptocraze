# üìä CryptoCraze Dashboard & BI Analytics - Setup Guide

## üöÄ –ü–æ–ª–Ω–∞—è BI —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

### –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

1. ‚úÖ **5 –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü BI –∞–Ω–∞–ª–∏—Ç–∏–∫–∏** –≤ –ë–î
2. ‚úÖ **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏
3. ‚úÖ **–ê–¥–º–∏–Ω—Å–∫–∞—è BI –ø–∞–Ω–µ–ª—å** —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
4. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** (batch –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π)
5. ‚úÖ **API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã** –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫
6. ‚úÖ **React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** –≤ —Å—Ç–∏–ª–µ –ø—Ä–æ–µ–∫—Ç–∞

---

## üõ†Ô∏è –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å:

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î:
```bash
# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ npm run db:migrate
npm run db:migrate

# –ò–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Ñ–∞–π–ª –Ω–∞–ø—Ä—è–º—É—é
psql -d your_database -f drizzle/0010_add_bi_analytics_tables.sql
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
```sql
-- –í PostgreSQL –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã:
SELECT tablename FROM pg_tables WHERE schemaname = 'public' 
AND tablename LIKE '%analytics%' OR tablename LIKE '%metrics%';

-- –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
-- user_daily_stats
-- cohort_analysis  
-- user_acquisition_metrics
-- engagement_metrics
-- revenue_metrics
```

### 3. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

**–î–∞—à–±–æ—Ä–¥ —É–∂–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ Profile.tsx:**
- –°—Ç–∞—Ä—ã–π `ProfileDashboard` –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ `EnhancedProfileDashboard`
- –ù–æ–≤—ã–π –¥–∞—à–±–æ—Ä–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 6 –º–µ—Ç—Ä–∏–∫ + –≥—Ä–∞—Ñ–∏–∫ + —Ç–æ–ø —Å–¥–µ–ª–∫–∏

**–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:**
```
/admin/analytics (—Ç—Ä–µ–±—É–µ—Ç isAdmin —Ä–æ–ª—å)
```

### 4. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –°–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–∞–∫–µ—Ç–∞–º–∏ –ø–æ 20 —à—Ç—É–∫ –∏–ª–∏ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- –¢—Ä–µ–∫–∏–Ω–≥ –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è —Å–¥–µ–ª–æ–∫ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω
- –ü—Ä–æ—Å–º–æ—Ç—Ä—ã —Å—Ç—Ä–∞–Ω–∏—Ü –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ:

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –¥–∞—à–±–æ—Ä–¥:
```typescript
import { useDashboard } from '../hooks/useDashboard';

const MyComponent = () => {
  const { stats, topDeals, isLoading, refreshDashboard } = useDashboard();
  
  // stats —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  // topDeals - –ª—É—á—à–∏–µ 5 —Å–¥–µ–ª–æ–∫
  // refreshDashboard() - –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
};
```

### –ê–¥–º–∏–Ω—Å–∫–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞:
```typescript
import { useAdminAnalytics } from '../hooks/useDashboard';

const AdminPanel = () => {
  const { 
    overview, 
    engagementData, 
    revenueData, 
    processDailyMetrics 
  } = useAdminAnalytics();
  
  // –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
  const handleProcessMetrics = () => processDailyMetrics();
};
```

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π:
```typescript
import { analyticsService } from '../services/analyticsService';

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç—Ä–µ–∫–∞–µ—Ç—Å—è:
// - –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–¥–µ–ª–æ–∫
// - –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–¥–µ–ª–æ–∫  
// - –ü—Ä–æ—Å–º–æ—Ç—Ä—ã —Å—Ç—Ä–∞–Ω–∏—Ü

// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ:
analyticsService.trackFeatureUsage('pro_mode', 'activate');
analyticsService.trackEngagement('click', 'chart_button');
analyticsService.trackError(error, 'trade_component');
```

---

## üéØ API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –¥–∞—à–±–æ—Ä–¥:
```
GET /api/dashboard/stats          - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
GET /api/dashboard/top-deals      - –¢–æ–ø 5 —Å–¥–µ–ª–æ–∫
GET /api/dashboard/profit-chart   - –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏–±—ã–ª–∏
```

### BI –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (–∞–¥–º–∏–Ω):
```
GET /api/admin/analytics/overview     - –û–±–∑–æ—Ä –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫
GET /api/admin/analytics/engagement   - –ú–µ—Ç—Ä–∏–∫–∏ –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏  
GET /api/admin/analytics/retention    - –ê–Ω–∞–ª–∏–∑ —É–¥–µ—Ä–∂–∞–Ω–∏—è
GET /api/admin/analytics/revenue      - –ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Ö–æ–¥–æ–≤
GET /api/admin/analytics/acquisition  - –ü—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

POST /api/admin/analytics/process-daily - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∑–∞ –¥–µ–Ω—å
```

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π:
```
POST /api/analytics/batch - –ü–∞–∫–µ—Ç–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π
```

---

## üé® –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

### –û—Å–Ω–æ–≤–Ω—ã–µ:
- `EnhancedProfileDashboard` - –£–ª—É—á—à–µ–Ω–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `ProfitLossChart` - –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏–±—ã–ª–∏/—É–±—ã—Ç–∫–æ–≤  
- `TopDealsWidget` - –í–∏–¥–∂–µ—Ç –ª—É—á—à–∏—Ö —Å–¥–µ–ª–æ–∫
- `AdminAnalytics` - –ê–¥–º–∏–Ω—Å–∫–∞—è BI –ø–∞–Ω–µ–ª—å

### –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:
```
src/components/dashboard/
‚îú‚îÄ‚îÄ EnhancedProfileDashboard.tsx
‚îú‚îÄ‚îÄ ProfitLossChart.tsx
‚îî‚îÄ‚îÄ TopDealsWidget.tsx

src/pages/Admin/
‚îî‚îÄ‚îÄ Analytics.tsx

src/services/
‚îî‚îÄ‚îÄ analyticsService.ts

src/hooks/
‚îî‚îÄ‚îÄ useDashboard.ts
```

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è:

### User Acquisition:
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (signups)
- –ü–µ—Ä–≤—ã–µ —Å–¥–µ–ª–∫–∏ (first trades)
- –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ —Ç–æ—Ä–≥–æ–≤–ª—é (trade open rate)
- –í—Ä–µ–º—è –¥–æ –ø–µ—Ä–≤–æ–π —Å–¥–µ–ª–∫–∏

### Engagement:
- DAU/WAU/MAU (–∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
- –°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ–∞–Ω—Å–∞
- –°–¥–µ–ª–æ–∫ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û–±—â–∏–π –æ–±—ä—ë–º —Ç–æ—Ä–≥–æ–≤–ª–∏

### Retention:
- D1, D3, D7, D30 —É–¥–µ—Ä–∂–∞–Ω–∏–µ
- –ö–æ–≥–æ—Ä—Ç –∞–Ω–∞–ª–∏–∑ –ø–æ –Ω–µ–¥–µ–ª—è–º
- Churn rate (–æ—Ç—Ç–æ–∫)

### Revenue:
- ARPU (–¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- ARPPU (–¥–æ—Ö–æ–¥ –Ω–∞ –ø–ª–∞—Ç—è—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)  
- –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø–ª–∞—Ç–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É
- LTV (lifetime value)

---

## üîß –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ:

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Ç—Ä–∏–∫:
–ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–æ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é:

**–ò–∑ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏:** –ù–∞–∂–∞—Ç—å "Process Today's Metrics"

**–ò–∑ PostgreSQL:**
```sql
-- –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
SELECT calculate_daily_metrics();

-- –ó–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É  
SELECT calculate_daily_metrics('2025-01-30');
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã:
- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–¥–µ–ª–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è `user_daily_stats`
- –§—É–Ω–∫—Ü–∏—è `calculate_daily_metrics()` –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è cron –∑–∞–¥–∞—á

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- –†–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏: `analyticsService.getQueueSize()`
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞: `analyticsService.flush()`

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ —Å 6 –º–µ—Ç—Ä–∏–∫–∞–º–∏
- ‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –ø—Ä–∏–±—ã–ª–∏/—É–±—ã—Ç–∫–æ–≤ –∑–∞ 30 –¥–Ω–µ–π
- ‚úÖ –¢–æ–ø-5 –ª—É—á—à–∏—Ö —Å–¥–µ–ª–æ–∫ —Å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é
- ‚úÖ ROI, —ç–Ω–µ—Ä–≥–∏—è, –º–æ–Ω–µ—Ç—ã

### –î–ª—è –∞–¥–º–∏–Ω–æ–≤:
- ‚úÖ –ü–æ–ª–Ω–∞—è BI –ø–∞–Ω–µ–ª—å —Å –∂–∏–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ acquisition, engagement, retention, revenue
- ‚úÖ –ö–æ–≥–æ—Ä—Ç –∞–Ω–∞–ª–∏–∑ –∏ —Ç—Ä–µ–Ω–¥—ã
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Ç—Ä–∏–∫ –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:
- ‚úÖ 5 –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü BI —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ –∏ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏
- ‚úÖ Batch –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å retry –ª–æ–≥–∏–∫–æ–π
- ‚úÖ –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è TypeScript
- ‚úÖ –°–ª–µ–¥—É–µ—Ç —Å—Ç–∏–ª—é –ø—Ä–æ–µ–∫—Ç–∞ CryptoCraze
- ‚úÖ Production-ready –∫–æ–¥

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ**

---

## üÜò Troubleshooting:

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** 
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π
npm run db:studio
# –ò–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL –Ω–∞–ø—Ä—è–º—É—é –≤ PostgreSQL
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç —Ä–æ–ª—å `isAdmin = true`

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** –ù–∞–∂–∞—Ç—å "Process Today's Metrics" –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –ì—Ä–∞—Ñ–∏–∫ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
**–†–µ—à–µ–Ω–∏–µ:** –ù—É–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–¥–µ–ª–æ–∫ –¥–ª—è –ø–æ—è–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞! üöÄ