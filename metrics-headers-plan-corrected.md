# ÐŸÐ»Ð°Ð½ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÑˆÐ°Ð¿Ð¾Ðº Ð¼ÐµÑ‚Ñ€Ð¸Ðº - Ð¡Ð Ð•Ð”ÐÐ•Ð• Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ”

## ðŸŽ¯ **ÐšÐ›Ð®Ð§Ð•Ð’ÐžÐ• Ð¢Ð Ð•Ð‘ÐžÐ’ÐÐÐ˜Ð•:**
**Ð’Ð¡Ð• Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¡Ð Ð•Ð”ÐÐ•Ð• Ð—Ð Ð’Ð«Ð‘Ð ÐÐÐÐ«Ð™ ÐŸÐ•Ð Ð˜ÐžÐ” Ð’ Ð¤Ð˜Ð›Ð¬Ð¢Ð Ð•, Ð° ÐÐ• Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ð´ÐµÐ½ÑŒ!**

## ðŸ“Š **ÐœÐµÑ‚Ñ€Ð¸ÐºÐ¸ Ñ "Avg." Ð² ÑˆÐ°Ð¿ÐºÐµ (ÐŸÐ•Ð Ð•ÐŸÐ˜Ð¡ÐÐ¢Ð¬):**

1. **Sessions** - `avgSessionsPerUser` = ÑÑ€ÐµÐ´Ð½ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐµÑÑÐ¸Ð¹ Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Avg sessions per user"
2. **Screens Opened** - `avgScreensPerUser` = ÑÑ€ÐµÐ´Ð½ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐºÑ€Ð°Ð½Ð¾Ð² Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Avg screens opened per user"
3. **Session Duration** - `avgSessionDuration` = ÑÑ€ÐµÐ´Ð½ÑÑ Ð´Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ ÑÐµÑÑÐ¸Ð¸ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Avg session duration in seconds"
4. **Trading Frequency** - `avgTradingFrequency` = ÑÑ€ÐµÐ´Ð½ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ´ÐµÐ»Ð¾Ðº Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Avg trades per user"
5. **Avg Virtual Balance** - `avgBalance` = ÑÑ€ÐµÐ´Ð½Ð¸Ð¹ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð±Ð°Ð»Ð°Ð½Ñ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Avg virtual balance"
6. **Trades/User** - `avgTradesPerUser` = ÑÑ€ÐµÐ´Ð½ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ´ÐµÐ»Ð¾Ðº Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Avg trades per user"
7. **Order Open** - `avgOrderOpen` = ÑÑ€ÐµÐ´Ð½ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ð¾Ñ€Ð´ÐµÑ€Ð¾Ð² Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Avg orders opened per user"
8. **Order Close** - `avgOrderClose` = ÑÑ€ÐµÐ´Ð½ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ð¾Ñ€Ð´ÐµÑ€Ð¾Ð² Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Avg orders closed per user"
9. **Average Profit/Loss** - `avgProfitLoss` = ÑÑ€ÐµÐ´Ð½Ð¸Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ñ‚/Ð»Ð¾ÑÑ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Avg profit/loss per trade"
10. **Average Holding Time** - `avgHoldingTime` = ÑÑ€ÐµÐ´Ð½ÐµÐµ Ð²Ñ€ÐµÐ¼Ñ ÑƒÐ´ÐµÑ€Ð¶Ð°Ð½Ð¸Ñ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Avg holding time in minutes"
11. **Page Visits** - `avgPageVisits` = ÑÑ€ÐµÐ´Ð½ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ð¾ÑÐµÑ‰ÐµÐ½Ð¸Ð¹ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ† Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Avg page visits per user"
12. **Daily Active Traders** - `avgDailyActiveTraders` = ÑÑ€ÐµÐ´Ð½ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€Ð¾Ð² Ð² Ð´ÐµÐ½ÑŒ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Avg daily active traders"

## ðŸ“ˆ **ÐœÐµÑ‚Ñ€Ð¸ÐºÐ¸ Ñ "Max." Ð² ÑˆÐ°Ð¿ÐºÐµ (ÐŸÐ•Ð Ð•ÐŸÐ˜Ð¡ÐÐ¢Ð¬):**
13. **Max Profit Trade** - `maxProfit` = Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ñ‚ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Max profit from single trade"
14. **Max Loss Trade** - `maxLoss` = Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð»Ð¾ÑÑ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ” + Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ: "Max loss from single trade"

## âœ… **ÐœÐµÑ‚Ñ€Ð¸ÐºÐ¸ Ð‘Ð•Ð— Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ (Ð¾ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÐ°Ðº ÐµÑÑ‚ÑŒ):**
- Win Rate, Signup Rate, Tutorial Start, Tutorial Complete, Pro Tutorial Start, Pro Tutorial Complete
- D1, D3, D7, D30, Churn Rate

## ðŸŽ¯ **Ð§Ñ‚Ð¾ Ð½ÑƒÐ¶Ð½Ð¾ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ:**

### 1. **Ð’ `loadMetricTotal()` Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ/Ð¿ÐµÑ€ÐµÐ¿Ð¸ÑÐ°Ñ‚ÑŒ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Ð´Ð»Ñ Ð²ÑÐµÑ… 14 Ð¼ÐµÑ‚Ñ€Ð¸Ðº Ð²Ñ‹ÑˆÐµ**
- **Ð’ÐÐ–ÐÐž:** ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð¼ÐµÑ‚Ð¾Ð´ Ð´Ð¾Ð»Ð¶ÐµÐ½ ÑÑ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ ÑÑ€ÐµÐ´Ð½ÐµÐµ/Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ Ð—Ð Ð’Ð•Ð¡Ð¬ ÐŸÐ•Ð Ð˜ÐžÐ” (Ð¾Ñ‚ startDate Ð´Ð¾ endDate)
- **ÐÐ• Ð±Ñ€Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ð´ÐµÐ½ÑŒ!**
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð°Ð³Ñ€ÐµÐ³Ð°Ñ‚Ð½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸: `AVG()`, `MAX()`, `SUM() / COUNT(DISTINCT user_id)`

### 2. **ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº Ð² `dashboardRoute.ts`:**
- Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð²ÑÐµ 14 Ð¼ÐµÑ‚Ñ€Ð¸Ðº Ð² Ð¼Ð°ÑÑÐ¸Ð² Ð´Ð»Ñ `getMetricTotal()`

### 3. **Ð’ `MetricsProps.tsx` Ð¾Ð±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ:**
- Ð¡Ð´ÐµÐ»Ð°Ñ‚ÑŒ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ ÐºÐ¾Ñ€Ð¾Ñ‡Ðµ Ð¸ Ð¿Ð¾Ð½ÑÑ‚Ð½ÐµÐµ Ð´Ð»Ñ Ð²ÑÐµÑ… 14 Ð¼ÐµÑ‚Ñ€Ð¸Ðº (Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ "Avg" Ð²Ð¼ÐµÑÑ‚Ð¾ "Average")

### 4. **ÐÐ• Ð¢Ð ÐžÐ“ÐÐ¢Ð¬:**
- Ð¡ÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… (`loadMetricTrend`)
- ClickHouse/PostgreSQL Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹
- Ð›Ð¾Ð³Ð¸ÐºÑƒ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° Ñ‚Ñ€ÐµÐ½Ð´Ð¾Ð²
- ÐœÐµÑ‚Ñ€Ð¸ÐºÐ¸ Ñ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð°Ð¼Ð¸ Ð¸ retention

## ðŸ“ **ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ SQL Ð´Ð»Ñ ÑÑ€ÐµÐ´Ð½Ð¸Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹ Ð—Ð ÐŸÐ•Ð Ð˜ÐžÐ”:**

```sql
-- Sessions: ÑÑ€ÐµÐ´Ð½ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐµÑÑÐ¸Ð¹ Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´
SELECT AVG(sessions_per_user) FROM (
  SELECT user_id, COUNT(DISTINCT session_id) as sessions_per_user
  FROM user_events 
  WHERE timestamp BETWEEN '${startDate}' AND '${endDate}'
  GROUP BY user_id
) t

-- Screens: ÑÑ€ÐµÐ´Ð½ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐºÑ€Ð°Ð½Ð¾Ð² Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´  
SELECT AVG(screens_per_user) FROM (
  SELECT user_id, COUNT(*) as screens_per_user
  FROM user_events 
  WHERE event_type = 'screen_view' AND timestamp BETWEEN '${startDate}' AND '${endDate}'
  GROUP BY user_id
) t

-- Session Duration: ÑÑ€ÐµÐ´Ð½ÑÑ Ð´Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ ÑÐµÑÑÐ¸Ð¸ Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´
SELECT AVG(session_duration) FROM (
  SELECT session_id, 
    MAX(timestamp) - MIN(timestamp) as session_duration
  FROM user_events 
  WHERE timestamp BETWEEN '${startDate}' AND '${endDate}'
  GROUP BY session_id
) t

-- Max Profit: Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ñ‚ Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´
SELECT MAX(profit) FROM deals 
WHERE closed_at BETWEEN '${startDate}' AND '${endDate}' 
  AND profit > 0
```
